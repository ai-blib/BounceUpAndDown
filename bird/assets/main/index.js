window.__require=function e(t,n,i){function c(s,o){if(!n[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var d="function"==typeof __require&&__require;if(!o&&d)return d(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){return c(t[s][1][e]||e)},u,u.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<i.length;s++)c(i[s]);return c}({GetUrlParam:[function(e,t,n){"use strict";cc._RF.push(t,"51465052bBODpl0Zs3yr3HY","GetUrlParam"),n.__esModule=!0,n.default=void 0;n.default=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?n[2]:null},t.exports=n.default,cc._RF.pop()},{}],Layer:[function(e,t){"use strict";cc._RF.push(t,"f85d8pC+XtIyJP2oKkbOz/j","Layer"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation(),console.log("TOUCH_STARTLayer")},this.node)}}),cc._RF.pop()},{}],MainManager:[function(e,t){"use strict";var n;cc._RF.push(t,"d5ac22s2TxFRI7dJDgO1VrJ","MainManager");var i=e("cb");cc.Class({extends:cc.Component,properties:(n={l_RoundTime:cc.Label,l_myName:cc.Label,l_oppositeName:cc.Label,s_myName:"\u73a9\u5bb61",s_oppositeName:"\u73a9\u5bb62",canvasW:720,canvasH:1280,isrun:!1,gameRoundNum:5,currentRound:1,i_myWin:0,i_oppositeWin:0},n.isrun=!1,n.b_isAI=!0,n.n_bird=[cc.Node],n.i_RoundTime=30,n.i_fly_up=100,n.i_fly_down=3,n.p_millile1=cc.Prefab,n.p_millile2=cc.Prefab,n.i_missileTime=2,n.n_bird_life=[cc.Node],n._a_bird_state=[],n._b_isbegin=!1,n.a_daoju=[cc.Prefab],n.daojunode=cc.Node,n._daodancount=0,n.readynode=cc.Node,n),start:function(){this._b_isbegin=!1,!cc.sys.isNative&&cc.sys.isMobile&&(this.node.getComponent(cc.Canvas).fitWidth=!0),cc.game.setFrameRate(60),cc.vv||(cc.vv={}),cc.vv.score=[0,0],this.initGame(),i.addEvent("event_start_poke",this.startPoke),i.addEvent("event_poke_result",this.handlePokeResult),i.addEvent("event_update",this.handleUpdate),this.showReady()},startPoke:function(e){var t=cc.g_Game.that;t.n_bird[1].y=e-t.canvasH/2,t.onfly(1)},handlePokeResult:function(e){var t="";0==e?t="bird":1==e?t="dunpai":2==e&&(t="daodan"),cc.g_Game.that.handleHit(1,0,t)},showReady:function(){var e=this;this.readynode.getChildByName("round").children[0].getComponent(cc.Label).string=this.currentRound+"round",this.currentRound++;for(var t=0;t<2;t++){var n=this.readynode.getChildByName("b"+t),i=n.getComponent(cc.Animation);this.n_bird[t].islose?(n.angle=0,n.y=0,i.play("round_lose"+t)):i.play("round_win"+t)}this.readynode.opacity=0,this.readynode.scale=3;var c=cc.spawn(cc.fadeTo(.5,255),cc.scaleTo(.5,1).easing(cc.easeBackOut()));this.readynode.runAction(c),this.scheduleOnce(function(){e.readynode.runAction(cc.spawn(cc.fadeTo(.5,0),cc.scaleTo(.5,3).easing(cc.easeBackOut()))),e.n_bird[0].islose=!1,e.n_bird[1].islose=!1,e._b_isbegin=!0,e.n_bird[0].getComponent(cc.Animation).play("fly0"),e.n_bird[1].getComponent(cc.Animation).play("fly1")},2)},restart:function(){var e=this;e._b_isbegin=!1,e.scheduleOnce(function(){if(cc.g_Game.b_isAI)for(var t=0;t<2;t++)if(e.n_bird_life[t].childrenCount<=0)return void cc.director.loadScene("Result");e.daojunode.destroyAllChildren(),e._a_bird_state[0]=[],e._a_bird_state[1]=[],e.n_bird[0].getChildByName("dunpai").active=!1,e.n_bird[1].getChildByName("dunpai").active=!1,e.n_bird[0].downspeed=this.i_fly_down,e.n_bird[1].downspeed=this.i_fly_down,e.i_RoundTime=30,e._daodancount=0,e.showReady()},2)},onlose:function(e){var t=this;t.n_bird[e].islose||(t.n_bird[e].angle=0,t.n_bird[e].stopAllActions(),t.n_bird[e].getComponent(cc.Animation).stop(),t.n_bird[e].getComponent(cc.Animation).play("lose"),t.n_bird[e].downspeed=0,t.n_bird[e].islose=!0,this.scheduleOnce(function(){var n=-520-t.n_bird[e].y;t.n_bird[e].runAction(cc.moveBy(.2,0,n));var i=0==e?1:0;if(cc.vv.score[i]++,t.n_bird[i].getChildByName("dunpai").active=!1,!t.n_bird[i].islose){var c=t.n_bird[i].getComponent(cc.Animation);0!=-520-t.n_bird[i].y?t.n_bird[i].runAction(cc.sequence(cc.moveBy(.2,0,-520-t.n_bird[e].y),cc.callFunc(function(){c.play("win")}))):c.play("win")}},.5,this))},handleHit:function(e,t,n){if(n.indexOf("bird")>=0){var i=t;if(this._a_bird_state[i].indexOf("dunpai")>=0)this._a_bird_state[i].splice(this._a_bird_state[i].indexOf("dunpai"),1),this.n_bird[i].getChildByName("dunpai").active=!1;else{this._b_isbegin&&this.restart();var c=this.n_bird_life[i].children[0];if(null==c)return;c.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeTo(.5,0)),cc.callFunc(function(){c.removeFromParent(),c.destroy()}))),this.onlose(i)}}else this._a_bird_state[e].push(n),"dunpai"==n&&(this.n_bird[e].getChildByName("dunpai").active=!0)},initGame:function(){var e=this;e.isrun=!0,cc.g_Game.that=this,e.l_myName=cc.find("Canvas/l_myName"),e.l_oppositeName=cc.find("Canvas/l_oppositeName"),e.l_myName.getComponent(cc.Label).string=cc.g_Game.selfName,e.l_oppositeName.getComponent(cc.Label).string=cc.vv.user2.nickName,cc.vv.user2.headsp&&(cc.find("Canvas/oppositeHerd/oppositeHerd").getComponent(cc.Sprite).spriteFrame=cc.vv.user2.headsp),this._a_bird_state.push([]),this._a_bird_state.push([]),e.n_bird[0].downspeed=this.i_fly_down,e.n_bird[1].downspeed=this.i_fly_down,this.node.on("Collision_push",function(t){var n=-1;t.target.indexOf("bird")>=0&&(n=0),t.target.indexOf("dunpai")>=0&&(n=1),t.target.indexOf("daodan")>=0&&(n=2),-1!=n&&(cc.g_Game.b_isAI?0==t.userindex?e.handleHit(0,1,t.target):e.handleHit(1,0,t.target):e.handleHit(0,1,t.target))}),this.n_bird[0].Zindex=99,this.n_bird[1].Zindex=99,this.n_bird[1].scaleX=-1,this.AI(1)},initRound:function(){this.l_gameEndTime=Date.now()/1e3+30,this.currentRound=this.currentRound+1,this.addImageTips("textures/dialoground")},addImageTips:function(e){var t=(new cc.Node).addComponent(cc.Sprite),n=cc.loader.getRes(e);t.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),t.node.parent=this.node,t.node.setPosition(0,0);var i=cc.moveTo(1,cc.v2(t.node.x,t.node.y+200));t.node.runAction(cc.sequence(i,cc.callFunc(function(){t.destroy()})))},onTouch:function(){this._b_isbegin&&(this.onfly(0),!cc.g_Game.b_isAI)&&this.n_bird[0]},onfly:function(e){if(this._b_isbegin&&!this.n_bird[e].islose){var t=this.n_bird[e],n=this.canvasH/2-t.y-222;if(n>0){n=n>this.i_fly_up?this.i_fly_up:n,t.downspeed=this.i_fly_down,t.getChildByName("flyanim").getComponent(cc.Animation).play("fly_same");var i=t.getComponent(cc.Animation).getAnimationState("fly"+e);i.speed=3,t.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,n)).easing(cc.easeOut(3)),cc.callFunc(function(){i.speed=1})))}}},onfire:function(e){if(cc.g_Game.that._b_isbegin){var t=null,n=8;0==e?t=this.p_millile1:(t=this.p_millile2,n=-n);var i=this.n_bird[e].getComponent(cc.Animation);i.play("fire"+e),i.getAnimationState("fire"+e).on("finished",function(){i.play("fly"+e)});var c=null;this._a_bird_state[e].indexOf("daodan")>=0&&(c=0==e?this.n_bird[1]:this.n_bird[0],this._a_bird_state[e].splice(this._a_bird_state[e].indexOf("daodan"),1));var a=1;switch(this.currentRound){case 4:case 5:a=2;break;case 6:a=3}for(var s=58*-(a-1)/2,o=this.n_bird[e].getPosition(),r=0;r<a;r++){var d=cc.instantiate(t),u=s+58*r;d.setPosition(cc.v2(o.x,o.y+u)),d.Zindex=1,d.scale=.1,d.parent=this.node,d.getComponent("MissileControl")._speed=n,d.name="Missile"+e,d.runAction(cc.scaleTo(.2,.8)),null!=c&&(d.getComponent("MissileControl")._targetNode=c)}}},AI:function(e){if(cc.g_Game.b_isAI){var t=Math.floor(5*Math.random())+1;this.canvasH/2-this.n_bird[e].y-222<200&&(t=Math.floor(30*Math.random())+1),t/=10;var n=0==e?1:0,i=this.node.getChildByName("Missile"+n);i&&(i.y-this.n_bird[e].y<80&&this.n_bird[e].x-i.x<200||this.n_bird[e].y-i.y<80&&0!=i.angle)&&(t=.1),this.scheduleOnce(function(){this._b_isbegin&&this.onfly(e),this.AI(e)},t)}},AI_createDaoJu:function(){if(!(this.daojunode.childrenCount>0)){var e=Math.floor(Math.random()*this.a_daoju.length);0==e?this._daodancount++:0==this._daodancount&&this.i_RoundTime<15&&(e=0,this._daodancount++);var t=cc.instantiate(this.a_daoju[e]);t.parent=this.daojunode;var n=Math.floor(560*Math.random())-280;t.setPosition(cc.v2(0,n)),t.active=!0}},createDaoJu:function(e){if(!(this.daojunode.childrenCount>0)&&0!=e.extend.length){var t=e.extend[0],n=Number(t.key),i=cc.instantiate(this.a_daoju[n]);i.parent=this.daojunode;var c=Number(t.value);i.setPosition(cc.v2(0,c)),i.active=!0}},handleUpdate:function(e){var t=cc.g_Game.that;if(t._b_isbegin){for(var n=0;n<2;n++)if(t.n_bird_life[n].childrenCount<=0)return void cc.director.loadScene("Result");t.onfire(1),t.onfire(0),t.createDaoJu(e)}},update:function(e){var t=this;if(this._b_isbegin){for(var n=0;n<2;n++)if(this.n_bird[n].y>-520&&!this.n_bird[n].islose){var i=this.n_bird[n].y+520;i=i>this.n_bird[n].downspeed?this.n_bird[n].downspeed:i,this.n_bird[n].y-=i,this.n_bird[n].downspeed+=.2,this.n_bird[n].y<-520&&(this.n_bird[n].y=-520)}if(this.i_RoundTime-=e,this.l_RoundTime.string=Math.round(this.i_RoundTime),this.i_RoundTime<=0){for(var c=function(e){var n=t.n_bird_life[e].children[0];if(null==n)return{v:void 0};n.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeTo(.5,0)),cc.callFunc(function(){n.removeFromParent(),n.destroy()}))),t.n_bird[e].getChildByName("dunpai").active=!1,t.onlose(e)},a=0;a<2;a++){var s=c(a);if("object"==typeof s)return s.v}this.restart()}else cc.g_Game.b_isAI&&(this.i_missileTime-=e,this.i_missileTime<=0&&(this.i_missileTime=2,this.onfire(1),this.onfire(0),1==Math.floor(3*Math.random())&&this.AI_createDaoJu()))}}}),cc._RF.pop()},{cb:"cb"}],MissileControl:[function(e,t){"use strict";cc._RF.push(t,"91b5c74nP1A35X0OPqMnoWl","MissileControl"),cc.Class({extends:cc.Component,properties:{_isdestroy:!1,_angle:90,_speed:20,canvasH:1280,canvasW:720,_targetNode:null},start:function(){cc.director.getCollisionManager().enabled=!0;var e=cc.director.getScene().getChildByName("Canvas");this.canvasW=e.width,this.canvasH=e.height},onCollisionEnter:function(e){var t=e.node.name;if(!("bird1"==t&&this._speed>0||"bird2"==t&&this._speed<0||t==this.node.name)){if("Missile1"==this.node.name&&!cc.g_Game.b_isAI)return t.indexOf("bird")<0&&(e.node.removeFromParent(),e.node.destroy()),void this.onBlast();t.indexOf("Missile")<0&&cc.director.getScene().getChildByName("Canvas").emit("Collision_push",{userindex:this._speed>0?0:1,target:e.node.name}),t.indexOf("bird")<0&&(e.node.removeFromParent(),e.node.destroy()),this.onBlast()}},onBlast:function(){this._isdestroy||(this._isdestroy=!0,this.node.removeFromParent(),this.node.destroy())},update:function(){if(!this._isdestroy){if(null==this._targetNode)this.node.x+=this._speed;else{var e=this._targetNode.getPosition();e=this._targetNode.parent.convertToWorldSpaceAR(e);var t=this.node.getPosition();t=this.node.parent.convertToWorldSpaceAR(t);var n=Math.atan2(e.y-t.y,e.x-t.x)*(180/Math.PI),i=90-n,c=Math.abs(n);this._speed>0?i=i+this.node.angle-90:(c=180-c,i=i+this.node.angle+90);var a=Math.abs(i);if(c>70);else if(a<4)this.node.angle-=i;else{a>180&&(i=i>0?i-360:i+360);var s=2,o=i>0?1:-1;a>80&&(s=5),this.node.angle-=s*o}var r=this._speed,d=-Math.PI/180*(180-this.node.angle),u=t.x-Math.cos(d)*r,l=t.y-Math.sin(d)*r;t=this.node.parent.convertToNodeSpaceAR(cc.v2(u,l)),this.node.setPosition(t)}Math.abs(this.node.x)>this.canvasW/2+30&&(this.node.removeFromParent(),this.node.destroy())}}}),cc._RF.pop()},{}],MusicManager:[function(e,t){"use strict";cc._RF.push(t,"c8cca7HLiRA0bHSpCgPcF6L","MusicManager"),cc.Class({extends:cc.Component,properties:{bgmVolume:1,sfxVolume:1,bgmAudioID:-1,path:""},init:function(e){var t;this.path=e+"/",null!=(t=cc.sys.localStorage.getItem("bgmVolume"))&&(this.bgmVolume=parseFloat(t)),null!=(t=cc.sys.localStorage.getItem("sfxVolume"))&&(this.sfxVolume=parseFloat(t)),cc.game.on(cc.game.EVENT_HIDE,function(){cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){cc.audioEngine.resumeAll()})},getAudioClip:function(e){return cc.loader.getRes(this.path+e,cc.AudioClip)},playBGM:function(e){var t=this.getAudioClip(e);this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmAudioID=cc.audioEngine.play(t,!0,this.bgmVolume)},playSFX:function(e){var t=this.getAudioClip(e);cc.audioEngine.play(t,!1,1)},setSFXVolume:function(e){this.sfxVolume!=e&&(cc.sys.localStorage.setItem("sfxVolume",e),this.sfxVolume=e)},setBGMVolume:function(e,t){this.bgmAudioID>=0&&(e>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID)),(this.bgmVolume!=e||t)&&(cc.sys.localStorage.setItem("bgmVolume",e),this.bgmVolume=e,cc.audioEngine.setVolume(this.bgmAudioID,e))},pauseAll:function(){cc.audioEngine.pauseAll()},resumeAll:function(){cc.audioEngine.resumeAll()}}),cc._RF.pop()},{}],ResultManager:[function(e,t){"use strict";cc._RF.push(t,"b2394ZIQXROKIXiBh7yVa8+","ResultManager");var n=c(e("./utils/GetUrlParam")),i=c(e("./utils/score"));function c(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{score:cc.Label},start:function(){var e;cc.g_Game.that=this,cc.vv.score?this.score.string=cc.vv.score[0]+" : "+cc.vv.score[1]:this.score.string="",console.log(cc.vv.score,"cc.vv.score");var t=(0,n.default)("user");(t=(t=t?decodeURIComponent(t):null)?JSON.parse(t):null)&&(0,i.default)(null==(e=t)?void 0:e.id,cc.vv.score[0]>cc.vv.score[1]),this.node.getChildByName("player1name").getComponent(cc.Label).string=cc.g_Game.selfName,this.node.getChildByName("player2name").getComponent(cc.Label).string=cc.vv.user2.nickName,cc.vv.user2.headsp&&(cc.find("Canvas/oppositeHerd/oppositeHerd").getComponent(cc.Sprite).spriteFrame=cc.vv.user2.headsp)},onBack:function(){cc.director.loadScene("Start")},onrestart:function(){cc.g_Game.userList=[],cc.g_Game.b_isAI=!0,cc.director.loadScene("Waiting")}}),cc._RF.pop()},{"./utils/GetUrlParam":"GetUrlParam","./utils/score":"score"}],StartManager:[function(e,t){"use strict";cc._RF.push(t,"46926onoGhAy6E9eWgdaEa2","StartManager"),cc.g_Game={},cc.g_Game.initData=function(e){cc.g_Game.userList=e,cc.g_Game.score=[0,0],cc.g_Game.game_state=0,cc.g_Game.b_isAI=!1,cc.g_Game.game_data=-1,cc.g_Game.seed=-1},e("./utils/cb"),cc.Class({extends:cc.Component,start:function(){if(!cc.vv){cc.vv={};var t=e("MusicManager");cc.vv.audioMgr=new t,cc.vv.audioMgr.init("Game/sounds"),cc.loader.loadResDir("Game/sounds",cc.AudioClip,function(){cc.vv.audioMgr.playBGM("backMusic")})}cc.g_Game.that=this,cc.g_Game.initData([]),cc.g_Game.is_single=!0},onGameBegin:function(){cc.g_Game.userList=[],cc.g_Game.b_isAI=!0,cc.g_Game.selfName="you",cc.director.loadScene("Waiting")}}),cc._RF.pop()},{"./utils/cb":"cb",MusicManager:"MusicManager"}],WaitingManager:[function(e,t){"use strict";function n(e,t){return Math.floor(Math.random()*(t-e+1)+e)}cc._RF.push(t,"e10dbvDU81IgLYYPqxUDRCh","WaitingManager"),cc.Class({extends:cc.Component,properties:{},start:function(){cc.find("Canvas/p1/name").getComponent(cc.Label).string=cc.g_Game.selfName,cc.find("Canvas/p2/name").getComponent(cc.Label).string="",cc.find("Canvas/p2/head/img").active=!1;var e=this.createUserInfo();cc.vv.user2=e;var t=n(10,30)/10;this.scheduleOnce(function(){cc.find("Canvas/p2/name").getComponent(cc.Label).string=e.nickName,cc.find("Canvas/p2/head/img").active=!0},t),cc.loader.loadRes("headimg/"+e.avatarUrl,cc.SpriteFrame,function(e,t){t&&(cc.find("Canvas/p2/head/img").getComponent(cc.Sprite).spriteFrame=t,cc.vv.user2.headsp=t)}),this.scheduleOnce(function(){cc.director.loadScene("Main")},t+1.5)},createUserInfo:function(){var e,t={};return t.sex=n(1,2),t.nickName=(e=["Alice","Ava","Emma","Olivia","Sophia","William","James","Benjamin","Henry","Alexander"])[Math.floor(Math.random()*e.length)],t.avatarUrl="https://api.multiavatar.com/"+n(0,1020)+".png",t}}),cc._RF.pop()},{}],cb:[function(e,t){"use strict";cc._RF.push(t,"3cf8dDBkFFHI4Bv5P8EgGZ8","cb");var n=function(){function e(){}var t=[],n=[];e.addEvent=function(a,s,o){o=null!=arguments[2]?arguments[2]:100,t[a]||(t[a]=[]);var r=e.getIndex(a,s);if(-1!=r)t[a][r].depth=o||r;else{var d=n.length?n.shift():new i;d.func=s,d.depth=o,t[a].push(d)}t[a].sort(c)},e.removeEvent=function(i,c){if(t[i]&&t[i].length){var a=e.getIndex(i,c);-1!=a&&n.push(t[i].splice(a,1))}},e.dispatchEvent=function(e,n){if(n=null!=arguments[1]?arguments[1]:null,t[e])for(var i=t[e].length-1;i>=0;i--)t[e]&&t[e][i]&&t[e][i].func.apply(null,n);else trace("[Warn] CBM\u6ca1\u6709\u5bf9\u5e94\u7684\u56de\u8c03\u7c7b\u578b - "+e)};var c=function(e,t){return t.depth-e.depth};return e.getIndex=function(e,n){for(var i=0,c=t[e].length;i<c;i++)if(n==t[e][i].func)return i;return-1},e}(),i=function(){this.func,this.depth};t.exports=n,cc._RF.pop()},{}],http:[function(e,t,n){"use strict";cc._RF.push(t,"05fe4rEIaZKFLNkrdW5r+PR","http"),n.__esModule=!0,n.default=void 0;var i={get:function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(n.status>=200&&n.status<300?t(null,n.responseText):t("HTTP Error: "+n.status))},n.open("GET",e,!0),n.send()},post:function(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300?n(null,i.responseText):n("HTTP Error: "+i.status))},i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(JSON.stringify(t))}};n.default=i,t.exports=n.default,cc._RF.pop()},{}],score:[function(e,t,n){"use strict";cc._RF.push(t,"00ca1VK+W5EQ6VAf2qOsAfn","score"),n.__esModule=!0,n.default=void 0;var i,c=(i=e("./http"))&&i.__esModule?i:{default:i};n.default=function(e,t){try{return c.default.get("https://main.d12ofx71u78ebe.amplifyapp.com/api/challenge/score?userId="+e+"&score="+t)}catch(n){return n}},t.exports=n.default,cc._RF.pop()},{"./http":"http"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"3fa4ar0UtNFtIHSdsPvh9I9","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["use_v2.1-2.2.1_cc.Toggle_event","MainManager","MissileControl","MusicManager","ResultManager","StartManager","WaitingManager","GetUrlParam","Layer","cb","http","score"]);